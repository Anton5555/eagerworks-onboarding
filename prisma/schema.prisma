generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["fullTextSearch"]
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Category {
    id         Int             @id @default(autoincrement())
    name       String
    gifts      Gift[]
    attributes GiftAttribute[]
    features   GiftFeature[]
}

model Gift {
    id          Int             @id @default(autoincrement())
    name        String
    categoryId  Int
    category    Category        @relation(fields: [categoryId], references: [id])
    providerId  Int
    provider    Provider        @relation(fields: [providerId], references: [id])
    description String?
    price       Float
    items       Gift_GiftItem[]
    attributes  GiftAttribute[]
    features    GiftFeature[]

    @@index([categoryId, providerId, name(sort: Asc)])
}

model Provider {
    id    Int    @id @default(autoincrement())
    name  String
    gifts Gift[]
}

model GiftItem {
    id             Int             @id @default(autoincrement())
    name           String
    price          Float?
    gift_giftItems Gift_GiftItem[]
}

model Gift_GiftItem {
    giftId     Int
    gift       Gift     @relation(fields: [giftId], references: [id])
    giftItemId Int
    giftItem   GiftItem @relation(fields: [giftItemId], references: [id])
    optional   Boolean

    @@unique([giftId, giftItemId])
    @@index([giftId])
    @@index([giftItemId])
}

model GiftAttribute {
    id         Int      @id @default(autoincrement())
    name       String
    categoryId Int
    category   Category @relation(fields: [categoryId], references: [id])
    gifts      Gift[]
}

model GiftFeature {
    id         Int      @id @default(autoincrement())
    name       String
    categoryId Int
    Category   Category @relation(fields: [categoryId], references: [id])
    gifts      Gift[]
}
